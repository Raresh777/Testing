<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Actors Leaderboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.1/papaparse.min.js"></script>
</head>
<body>
    <h1>Actors Leaderboard Generator</h1>
    <input type="file" id="fileInput" />
    <button id="processButton">Process CSV</button>
    <h2>Leaderboard:</h2>
    <pre id="output"></pre>

    <script>
        document.getElementById('processButton').addEventListener('click', function () {
            const fileInput = document.getElementById('fileInput');
            if (!fileInput.files.length) {
                alert('Please upload a CSV file.');
                return;
            }

            const file = fileInput.files[0];

            Papa.parse(file, {
                header: true,
                skipEmptyLines: true,
                complete: function (results) {
                    const data = results.data;

                    // Step 1: Split the 'ad_name' column by space
                    data.forEach(row => {
                        if (row.ad_name) {
                            const splitData = row.ad_name.split(' ');
                            row.Location = row.Location || splitData[0];
                            row.Language = row.Language || splitData[1];
                            row.Actor = splitData[2]; // Assuming column G contains names post-split
                        }
                    });

                    // Step 2: Count the occurrences of each actor
                    const actorStats = {};
                    data.forEach(row => {
                        const key = `${row.Actor}|${row.Location}|${row.Language}`;
                        if (actorStats[key]) {
                            actorStats[key]++;
                        } else {
                            actorStats[key] = 1;
                        }
                    });

                    // Step 3: Format the statistics for display
                    const formattedStats = Object.entries(actorStats).map(([key, count]) => {
                        const [actor, location, language] = key.split('|');
                        return `${actor} - ${location} - ${language}: ${count}`;
                    });

                    // Display the leaderboard
                    document.getElementById('output').textContent = formattedStats.join('\n');
                },
                error: function (error) {
                    console.error('Error parsing CSV:', error);
                }
            });
        });
    </script>
</body>
</html>
